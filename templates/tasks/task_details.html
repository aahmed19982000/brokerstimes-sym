{% extends 'base.html' %}
{% load static %}

{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/task_details.css' %}">
{% endblock %}

{% block content %}
<div class="task-details-container">
  <h2>ğŸ“„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©</h2>

  <!-- ØªÙØ§ØµÙŠÙ„ Ø«Ø§Ø¨ØªØ© Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø· -->
  <div class="detail-item">
    <strong>Ø§Ù„ÙƒØ§ØªØ¨:</strong>
    <p>{{ task.writer.get_full_name|default:task.writer.username }}</p>
  </div>
  
  
  <div class="detail-item">
    <strong>[Ø§Ù„Ù†ÙˆØ¹]:</strong>
    <p>{{ task.article_type_W_R_A_B|default:"-" }}</p>
  </div>
  
  <div class="detail-item">
    <strong>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„:</strong>
    <p>{{ task.article_title }}</p>
  </div>
  
  <div class="detail-item">
    <strong>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„:</strong>
    <p>{{ task.article_details }}</p>
  </div>
  
  <div class="detail-item">
    <strong>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù†Ø´Ø±:</strong>
    <p>{{ task.publish_site|default:"-" }}</p>
  </div>
  
  <div class="detail-item">
    <strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø´Ø±:</strong>
    <p>{{ task.publish_date|default:"-" }}</p>
  </div>

  <hr>

  <!-- Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ (Ù„Ù„ØªØ¹Ø¯ÙŠÙ„) -->
  <form method="post" class="task-form">
    {% csrf_token %}
    {% if request.user.role == "manager" %}
      <!-- Ø§Ù„Ù…Ø¯ÙŠØ± ÙŠØ¹Ø¯Ù„ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„ -->
      {% for field in form %}
      <div class="form-group">
        <label for="{{ field.id_for_label }}">{{ field.label }}</label>
        {{ field }}
        {% if field.help_text %}
          <small style="color: #6c757d;">{{ field.help_text }}</small>
        {% endif %}
        {% for error in field.errors %}
          <div style="color: #e74a3b; margin-top: 5px;">{{ error }}</div>
        {% endfor %}
      </div>
      {% endfor %}
      <button type="submit" class="btn">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
    {% else %}
      <!-- Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø¹Ø§Ø¯ÙŠ ÙŠØ¹Ø¯Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§ ÙÙ‚Ø· -->
      <div class="alert alert-info">
        ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙ‚Ø·:
      </div>
      
      <div class="form-group">
        <label for="status">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù‚Ø§Ù„:</label>
        <select name="status" id="status">
          {% for value, label in status_choices %}
            <option value="{{ value }}" {% if task.status == value %}selected{% endif %}>{{ label }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label for="article_link">ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù‚Ø§Ù„:</label>
        <input type="text" name="article_link" id="article_link" value="{{ task.article_link }}">
      </div>

      <div class="form-group">
        <label for="image">ğŸ–¼ï¸ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</label>
        <input type="text" name="image" id="image" value="{{ task.image }}">
      </div>

      <div class="form-group">
        <label for="image_type">ğŸ“Œ Ù†ÙˆØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</label>
        <select name="image_type" id="image_type">
          {% for value, label in image_type_choices %}
            <option value="{{ value }}" {% if task.image_type == value %}selected{% endif %}>{{ label }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label for="image_details">ğŸ“ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©:</label>
        <textarea name="image_details" id="image_details">{{ task.image_details }}</textarea>
      </div>

      <button type="submit" class="btn">ğŸ’¾ ØªØ­Ø¯ÙŠØ«</button>
    {% endif %}
  </form>

  <hr>

  <!-- Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
  <div class="action-section">
    <strong>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª:</strong>
    <div class="action-links">
      {% if request.user.role == "manager" %}
        <a href="{% url 'edit_task' task.id %}" class="btn btn-secondary">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©</a>
        <a href="{% url 'delete_task' task.id %}" class="btn btn-danger" onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ');">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©</a>
      {% else %}
        <span style="color: #6c757d; padding: 10px; background: #f8f9fa; border-radius: 6px;">
          ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ§Ù„Ø­Ù‚ÙˆÙ„ Ø£Ø¹Ù„Ø§Ù‡ ÙÙ‚Ø·
        </span>
      {% endif %}
    </div>
  </div>

  <a class="back-link" onclick="window.close();">ğŸ”™ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©</a>
</div>
{% endblock %}