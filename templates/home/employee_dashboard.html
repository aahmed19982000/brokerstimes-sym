{% extends 'base.html' %}
{% load static %}


{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/employee_dashboard.css' %}">
  <title>ููุญุฉ ุชุญูู ุงูููุธู - ูุธุงู ุฅุฏุงุฑุฉ ุงูููุงู</title>
  <meta name="title" content="ููุญุฉ ุชุญูู ุงูููุธู - ูุธุงู ุฅุฏุงุฑุฉ ุงููู  ุงู">
  <meta name="description" content="ููุญุฉ ุชุญูู ุงูููุธู ูู ูุธุงู ุฅุฏุงุฑุฉ ุงูููุงู. ุงุณุชุนุฑุถ ุฅุญุตุงุฆูุงุช ุฃุฏุงุฆู ูุงูููุงู ุงููุทููุจุฉ ููู ูุน ูุงุฌูุฉ ูุณุชุฎุฏู ุณููุฉ ุงูุงุณุชุฎุฏุงู.">
  
{% endblock %}

{% block content %}
  <h1>๐ ูุฑุญุจูุง {{ request.user.get_full_name|default:request.user.username }}</h1>
  <p>ูุฐู ููุญุฉ ุณุฑูุนุฉ ุนู ุฃุฏุงุฆู ูุงูููุงู ุงููุทููุจุฉ ุงูููู</p>

  <div class="stats">
    <div class="stat-box">
      <h2>{{ total_tasks }}</h2>
      <p>ุนุฏุฏ ุงูููุงู  </p>
    </div>
    <div class="stat-box">
      <h2>{{ completed_tasks }}</h2>
      <p>ุงูููุงู ุงูููุชููุฉ</p>
    </div>
    <div class="stat-box">
      <h2>{{ pending_tasks }}</h2>
      <p>ุงูููุงู ุงููุชุจููุฉ</p>
    </div>
    <div class="stat-box">
      <h2>{{ completed_publish }}</h2>
      <p>ุงูููุงู ุงูููุดูุฑุฉ</p>
    </div>
    <div class="stat-box">
      <h2>{{ progress_percent }}%</h2>
      <p>ูุณุจุฉ ุงูุฅูุฌุงุฒ</p>
    </div>
  </div>

  <h2>๐ ุงูููุงู ุงููุทููุจุฉ ุงูููู</h2>
  {% if todays_tasks %}
    <table class="task-table">
      <thead>
        <tr>
          <th>ุนููุงู ุงูููุงู</th>
          <th>[ุงูููุน]</th>
          <th>ุงูุชูุงุตูู</th>
          <th>ุฑุงุจุท ุงูููุงู</th>
          <th>ูููุน ุงููุดุฑ</th>
          <th>ุชุงุฑูุฎ ุงููุดุฑ</th>
          <th>ุงูุญุงูุฉ</th>
          <th>ุนุฑุถ ุงููุฒูุฏ</th>
        </tr>
      </thead>
      <tbody>
        {% for task in todays_tasks %}
          <tr>
            <td>{{ task.article_title }}</td>
            <td>{{ task.article_type_W_R_A_B }}</td>
            <td>{{ task.article_details }}</td>
            <td>
              <form method="post" action="{% url 'update_article_link' task.id %}">
                {% csrf_token %}
                <input type="url" name="article_link" value="{{ task.article_link }}" placeholder="ุฃุฏุฎู ุงูุฑุงุจุท" required>
                <button type="submit">๐พ ุญูุธ</button>
              </form>
            </td>
            <td>{{ task.publish_site }}</td>
            <td>{{ task.publish_date|date:"Y-m-d" }}</td>
            <td>
              <form method="post" action="{% url 'update_task_status' task.id %}">{% csrf_token %}
                <select name="status">
                  <option value="in_progress" {% if task.status == 'in_progress' %}selected{% endif %}>โณ ุฌุงุฑู ุงูุนูู</option>
                  <option value="upload" {% if task.status == 'upload' %}selected{% endif %}>๐ค ุชู ุงูุฑูุน</option>
                  <option value="publish" {% if task.status == 'publish' %}selected{% endif %}>๐ข ุชู ุงููุดุฑ</option>
                  <option value="done" {% if task.status == 'done' %}selected{% endif %}>โ ููุชููุฉ</option>
                </select>
                <button type="submit">๐พ ุญูุธ</button>
              </form>
            </td>
            <td>
              <a href="{% url 'task_details' task.id %}" target="_blank">๐๏ธ ุนุฑุถ</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>๐ ูุง ุชูุฌุฏ ููุงู ูุฌุฏููุฉ ุงูููู! ุงุณุชูุชุน ุจููุชู ๐</p>
  {% endif %}

  <h2 style="margin-top: 40px;">โ๏ธ ุงูููุงู ุงููุคุฎุฑุฉ</h2>
  {% if overdue_tasks %}
    <table class="task-table">
      <thead>
        <tr>
          <th>ุนููุงู ุงูููุงู</th>
          <th>[ุงูููุน]</th>
          <th>ุงูุชูุงุตูู</th>
          <th>ุฑุงุจุท ุงูููุงู</th>
          <th>ูููุน ุงููุดุฑ</th>
          <th>ุชุงุฑูุฎ ุงููุดุฑ</th>
          <th>ุงูุญุงูุฉ</th>
          <th>ุนุฑุถ ุงููุฒูุฏ</th>
        </tr>
      </thead>
      <tbody>
        {% for task in overdue_tasks %}
          <tr>
            <td>{{ task.article_title }}</td>
            <td>{{ task.article_type_W_R_A_B }}</td>
            <td>{{ task.article_details }}</td>
            <td>
              <form method="post" action="{% url 'update_article_link' task.id %}">
                {% csrf_token %}
                <input type="url" name="article_link" value="{{ task.article_link }}" placeholder="ุฃุฏุฎู ุงูุฑุงุจุท" required>
                <button type="submit">๐พ ุญูุธ</button>
              </form>
            </td>
            <td>{{ task.publish_site }}</td>
            <td>{{ task.publish_date|date:"Y-m-d" }}</td>
            <td>
              <form method="post" action="{% url 'update_task_status' task.id %}">{% csrf_token %}
                <select name="status">
                  <option value="in_progress" {% if task.status == 'in_progress' %}selected{% endif %}>โณ ุฌุงุฑู ุงูุนูู</option>
                  <option value="upload" {% if task.status == 'upload' %}selected{% endif %}>๐ค ุชู ุงูุฑูุน</option>
                  <option value="publish" {% if task.status == 'publish' %}selected{% endif %}>๐ข ุชู ุงููุดุฑ</option>
                  <option value="done" {% if task.status == 'done' %}selected{% endif %}>โ ููุชููุฉ</option>
                </select>
                <button type="submit">๐พ ุญูุธ</button>
              </form>
            </td>
            <td>
              <a href="{% url 'task_details' task.id %}" target="_blank">๐๏ธ ุนุฑุถ</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>๐ ูุง ุชูุฌุฏ ููุงู ูุคุฎุฑุฉ</p>
  {% endif %}

  <h2 style="text-align: center; margin-bottom: 20px;">๐ธ ููุงูุงุช ุชุญุชุงุฌ ุงูู ุตูุฑ ุชู ุงุฑุณููุง ูููุตูู</h2>
<table class="task-table">
  <thead>
    <tr>
      <th>[ุงูููุน]</th>
      <th>ุนููุงู ุงูุตูุฑุฉ ุงููุทููุจุฉ</th>
      <th>ูููุน ุงููุดุฑ</th>
      <th>ููุน ุงูุตูุฑุฉ</th>
      <th>ุญุงูุฉ ุงูุตูุฑุฉ</th>
      <th>ุญุงูุฉ ุงูููุงู</th>
      <th>ุงููุฒูุฏ</th>
    </tr>
  </thead>
  <tbody>
    {% for task in image_in_progress %}
      <tr>
        <td>{{ task.article_type_W_R_A_B }}</td>
        <td>{{ task.image }}</td>
        <td>{{ task.publish_site }}</td>
        <td>{{ task.get_image_type_display }}</td>
        <td>{{ task.get_image_status_display }}</td>
        <td>{{ task.get_status_display }}</td>
        <td><a href="{% url 'task_details' task.id %}" target="_blank">๐๏ธ</a></td>
      </tr>
    {% empty %}
      <tr><td colspan="8" style="text-align: center;">ูุง ุชูุฌุฏ ุตูุฑ ูุทููุจุฉ ูู ุงููุตูู </td></tr>
    {% endfor %}
  </tbody>
</table>


<h2 style="text-align: center; margin-bottom: 20px;">๐ธ ููุงูุงุช ุชุญุชุงุฌ ุงูู ุฑูุน ุงูุตูุฑ</h2>
<table class="task-table">
  <thead>
    <tr>
      <th>[ุงูููุน]</th>
      <th>ุนููุงู ุงูุตูุฑุฉ ุงููุทููุจุฉ</th>
      <th>ูููุน ุงููุดุฑ</th>
      <th>ููุน ุงูุตูุฑุฉ</th>
      <th>ุญุงูุฉ ุงูุตูุฑุฉ</th>
      <th>ุญุงูุฉ ุงูููุงู</th>
      <th>ุงููุฒูุฏ</th>
    </tr>
  </thead>
  <tbody>
    {% for task in image_in_send %}
      <tr>
        <td>{{ task.article_type_W_R_A_B }}</td>
        <td>{{ task.image }}</td>
        <td>{{ task.publish_site }}</td>
        <td>{{ task.get_image_type_display }}</td>
        
        <td>
          <form method="post" action="{% url 'update_image_status' task.id %}">
            {% csrf_token %}
            <select name="image_status" onchange="this.form.submit()">
              <option value="in_progress" {% if task.image_status == 'in_progress' %}selected{% endif %}>โณ ุฌุงุฑู ุงูุนูู</option>
              <option value="send" {% if task.image_status == 'send' %}selected{% endif %}>ุชู ุงูุงุฑุณุงู ูููุงุชุจ</option>
              <option value="publish" {% if task.image_status == 'publish' %}selected{% endif %}>โ ุชู ุงูุฑูุน ุนูู ุงููููุน</option>
            </select>
          </form>
        </td>
        
        <td>{{ task.get_status_display }}</td>
        <td><a href="{% url 'task_details' task.id %}" target="_blank">๐๏ธ</a></td>
      </tr>
    {% empty %}
      <tr><td colspan="8" style="text-align: center;">ูุง ุชูุฌุฏ ุตูุฑ ูุทููุจุฉ ูู ุงููุตูู </td></tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
