{% extends 'base.html' %}
{% load static %}

{% block title %}Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…ÙˆØ¸Ù{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/employee_dashboard.css' %}">
{% endblock %}

{% block content %}
  <h1>ğŸ‘‹ Ù…Ø±Ø­Ø¨Ù‹Ø§ {{ request.user.get_full_name|default:request.user.username }}</h1>
  <p>Ù‡Ø°Ù‡ Ù„Ù…Ø­Ø© Ø³Ø±ÙŠØ¹Ø© Ø¹Ù† Ø£Ø¯Ø§Ø¦Ùƒ ÙˆØ§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø§Ù„ÙŠÙˆÙ…</p>

  <div class="stats">
    <div class="stat-box">
      <h2>{{ total_tasks }}</h2>
      <p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù…  </p>
    </div>
    <div class="stat-box">
      <h2>{{ completed_tasks }}</h2>
      <p>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</p>
    </div>
    <div class="stat-box">
      <h2>{{ pending_tasks }}</h2>
      <p>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</p>
    </div>
    <div class="stat-box">
      <h2>{{ completed_publish }}</h2>
      <p>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©</p>
    </div>
    <div class="stat-box">
      <h2>{{ progress_percent }}%</h2>
      <p>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</p>
    </div>
  </div>

  <h2>ğŸ“… Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø§Ù„ÙŠÙˆÙ…</h2>
  {% if todays_tasks %}
    <table class="task-table">
      <thead>
        <tr>
          <th>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„</th>
          <th>[Ø§Ù„Ù†ÙˆØ¹]</th>
          <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
          <th>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù‚Ø§Ù„</th>
          <th>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù†Ø´Ø±</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø´Ø±</th>
          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
          <th>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯</th>
        </tr>
      </thead>
      <tbody>
        {% for task in todays_tasks %}
          <tr>
            <td>{{ task.article_title }}</td>
            <td>{{ task.article_type_W_R_A_B }}</td>
            <td>{{ task.article_details }}</td>
            <td>
              <form method="post" action="{% url 'update_article_link' task.id %}">
                {% csrf_token %}
                <input type="url" name="article_link" value="{{ task.article_link }}" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·" required>
                <button type="submit">ğŸ’¾ Ø­ÙØ¸</button>
              </form>
            </td>
            <td>{{ task.publish_site }}</td>
            <td>{{ task.publish_date|date:"Y-m-d" }}</td>
            <td>
              <form method="post" action="{% url 'update_task_status' task.id %}">{% csrf_token %}
                <select name="status">
                  <option value="in_progress" {% if task.status == 'in_progress' %}selected{% endif %}>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„</option>
                  <option value="upload" {% if task.status == 'upload' %}selected{% endif %}>ğŸ“¤ ØªÙ… Ø§Ù„Ø±ÙØ¹</option>
                  <option value="publish" {% if task.status == 'publish' %}selected{% endif %}>ğŸ“¢ ØªÙ… Ø§Ù„Ù†Ø´Ø±</option>
                  <option value="done" {% if task.status == 'done' %}selected{% endif %}>âœ… Ù…ÙƒØªÙ…Ù„Ø©</option>
                </select>
                <button type="submit">ğŸ’¾ Ø­ÙØ¸</button>
              </form>
            </td>
            <td>
              <a href="{% url 'task_details' task.id %}" target="_blank">ğŸ‘ï¸ Ø¹Ø±Ø¶</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>ğŸ‰ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù…Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„ÙŠÙˆÙ…! Ø§Ø³ØªÙ…ØªØ¹ Ø¨ÙˆÙ‚ØªÙƒ ğŸˆ</p>
  {% endif %}

  <h2 style="margin-top: 40px;">âš ï¸ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø¤Ø®Ø±Ø©</h2>
  {% if overdue_tasks %}
    <table class="task-table">
      <thead>
        <tr>
          <th>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„</th>
          <th>[Ø§Ù„Ù†ÙˆØ¹]</th>
          <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
          <th>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù‚Ø§Ù„</th>
          <th>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù†Ø´Ø±</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø´Ø±</th>
          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
          <th>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯</th>
        </tr>
      </thead>
      <tbody>
        {% for task in overdue_tasks %}
          <tr>
            <td>{{ task.article_title }}</td>
            <td>{{ task.article_type_W_R_A_B }}</td>
            <td>{{ task.article_details }}</td>
            <td>
              <form method="post" action="{% url 'update_article_link' task.id %}">
                {% csrf_token %}
                <input type="url" name="article_link" value="{{ task.article_link }}" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·" required>
                <button type="submit">ğŸ’¾ Ø­ÙØ¸</button>
              </form>
            </td>
            <td>{{ task.publish_site }}</td>
            <td>{{ task.publish_date|date:"Y-m-d" }}</td>
            <td>
              <form method="post" action="{% url 'update_task_status' task.id %}">{% csrf_token %}
                <select name="status">
                  <option value="in_progress" {% if task.status == 'in_progress' %}selected{% endif %}>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„</option>
                  <option value="upload" {% if task.status == 'upload' %}selected{% endif %}>ğŸ“¤ ØªÙ… Ø§Ù„Ø±ÙØ¹</option>
                  <option value="publish" {% if task.status == 'publish' %}selected{% endif %}>ğŸ“¢ ØªÙ… Ø§Ù„Ù†Ø´Ø±</option>
                  <option value="done" {% if task.status == 'done' %}selected{% endif %}>âœ… Ù…ÙƒØªÙ…Ù„Ø©</option>
                </select>
                <button type="submit">ğŸ’¾ Ø­ÙØ¸</button>
              </form>
            </td>
            <td>
              <a href="{% url 'task_details' task.id %}" target="_blank">ğŸ‘ï¸ Ø¹Ø±Ø¶</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>ğŸ‘Œ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù…Ø¤Ø®Ø±Ø©</p>
  {% endif %}

  <h2 style="text-align: center; margin-bottom: 20px;">ğŸ“¸ Ù…Ù‚Ø§Ù„Ø§Øª ØªØ­ØªØ§Ø¬ Ø§Ù„ÙŠ ØµÙˆØ± ØªÙ… Ø§Ø±Ø³Ù„Ù‡Ø§ Ù„Ù„Ù…ØµÙ…Ù…</h2>
<table class="task-table">
  <thead>
    <tr>
      <th>[Ø§Ù„Ù†ÙˆØ¹]</th>
      <th>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</th>
      <th>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù†Ø´Ø±</th>
      <th>Ù†ÙˆØ¹ Ø§Ù„ØµÙˆØ±Ø©</th>
      <th>Ø­Ø§Ù„Ø© Ø§Ù„ØµÙˆØ±Ø©</th>
      <th>Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù‚Ø§Ù„</th>
      <th>Ø§Ù„Ù…Ø²ÙŠØ¯</th>
    </tr>
  </thead>
  <tbody>
    {% for task in image_in_progress %}
      <tr>
        <td>{{ task.article_type_W_R_A_B }}</td>
        <td>{{ task.image }}</td>
        <td>{{ task.publish_site }}</td>
        <td>{{ task.get_image_type_display }}</td>
        <td>{{ task.get_image_status_display }}</td>
        <td>{{ task.get_status_display }}</td>
        <td><a href="{% url 'task_details' task.id %}" target="_blank">ğŸ‘ï¸</a></td>
      </tr>
    {% empty %}
      <tr><td colspan="8" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ù…ØµÙ…Ù… </td></tr>
    {% endfor %}
  </tbody>
</table>


<h2 style="text-align: center; margin-bottom: 20px;">ğŸ“¸ Ù…Ù‚Ø§Ù„Ø§Øª ØªØ­ØªØ§Ø¬ Ø§Ù„ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±</h2>
<table class="task-table">
  <thead>
    <tr>
      <th>[Ø§Ù„Ù†ÙˆØ¹]</th>
      <th>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</th>
      <th>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù†Ø´Ø±</th>
      <th>Ù†ÙˆØ¹ Ø§Ù„ØµÙˆØ±Ø©</th>
      <th>Ø­Ø§Ù„Ø© Ø§Ù„ØµÙˆØ±Ø©</th>
      <th>Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù‚Ø§Ù„</th>
      <th>Ø§Ù„Ù…Ø²ÙŠØ¯</th>
    </tr>
  </thead>
  <tbody>
    {% for task in image_in_send %}
      <tr>
        <td>{{ task.article_type_W_R_A_B }}</td>
        <td>{{ task.image }}</td>
        <td>{{ task.publish_site }}</td>
        <td>{{ task.get_image_type_display }}</td>
        
        <td>
          <form method="post" action="{% url 'update_image_status' task.id %}">
            {% csrf_token %}
            <select name="image_status" onchange="this.form.submit()">
              <option value="in_progress" {% if task.image_status == 'in_progress' %}selected{% endif %}>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„</option>
              <option value="send" {% if task.image_status == 'send' %}selected{% endif %}>ØªÙ… Ø§Ù„Ø§Ø±Ø³Ø§Ù„ Ù„Ù„ÙƒØ§ØªØ¨</option>
              <option value="publish" {% if task.image_status == 'publish' %}selected{% endif %}>âœ… ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹</option>
            </select>
          </form>
        </td>
        
        <td>{{ task.get_status_display }}</td>
        <td><a href="{% url 'task_details' task.id %}" target="_blank">ğŸ‘ï¸</a></td>
      </tr>
    {% empty %}
      <tr><td colspan="8" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ù…ØµÙ…Ù… </td></tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
